<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <title>Job-list</title>
</head>
<body>

  <div class="container my-4">
    <!-- üîç Search Form -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="mb-0">Job Listings</h2>
      <form method="get" action="" class="d-flex">
        <input type="text" name="q" class="form-control me-2" placeholder="Search jobs..." value="{{ query }}">
        <button type="submit" class="btn btn-outline-primary">Search</button>
      </form>
    </div>

    {% for job in jobs %}
    <div class="card mb-4 shadow-sm">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div>
            <h5 class="card-title mb-1">{{ job.title }}</h5>
            <p class="text-muted mb-1">({{ job.vacancies|default:"1" }})</p>
            {% if job.salary %}
              <p class="fw-bold text-success">‚Ç±{{ job.salary }}</p>
            {% endif %}
            <p class="mb-1"><span class="text-success fw-bold">‚óè</span> {{ job.company.name }} ¬∑ <a href="{% url 'jobs:job_detail' job.id %}">View Job</a></p>
            <p class="mb-1">{{ job.city }}, {{ job.province }}</p>

            {% if job.skill_list %}
              <p class="mb-1"><strong>Skills:</strong>
                {% for skill in job.skill_list %}
                  <span class="badge bg-secondary me-1">{{ skill }}</span>
                {% endfor %}
              </p>
            {% endif %}

            {% if job.perk_list %}
              <p class="mb-1"><strong>Perks:</strong>
                {% for perk in job.perk_list %}
                  <span class="badge bg-light border me-1 text-dark">{{ perk }}</span>
                {% endfor %}
              </p>
            {% endif %}
          </div>

          <div class="text-end text-muted small">
            Posted: {{ job.posted_at|date:"Y-m-d" }}
          </div>
        </div>

        <div class="mt-3 d-flex gap-2">
          <button class="btn btn-primary btn-sm">
            <img src="/static/icons/save.png" width="16" class="me-1"> Save
          </button>
          <button class="btn btn-info btn-sm text-white">
            <img src="/static/icons/share.png" width="16" class="me-1"> Share
          </button>
          <a href="{% url 'jobs:apply' job.id %}" class="btn btn-success btn-sm">
            <img src="/static/icons/apply.png" width="16" class="me-1"> Apply
          </a>
        </div>
      </div>
    </div>
    {% empty %}
      <p>No jobs found.</p>
    {% endfor %}
  </div>
  <!-- Pagination Controls -->
  <nav>
    <ul class="pagination justify-content-center">
      {% if jobs.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?q={{ query }}&page={{ jobs.previous_page_number }}">Previous</a>
        </li>
      {% else %}
        <li class="page-item disabled">
          <span class="page-link">Previous</span>
        </li>
      {% endif %}

      {% for num in jobs.paginator.page_range %}
        {% if jobs.number == num %}
          <li class="page-item active"><span class="page-link">{{ num }}</span></li>
        {% elif num > jobs.number|add:'-3' and num < jobs.number|add:'3' %}
          <li class="page-item"><a class="page-link" href="?q={{ query }}&page={{ num }}">{{ num }}</a></li>
        {% endif %}
      {% endfor %}

      {% if jobs.has_next %}
        <li class="page-item">
          <a class="page-link" href="?q={{ query }}&page={{ jobs.next_page_number }}">Next</a>
        </li>
      {% else %}
        <li class="page-item disabled">
          <span class="page-link">Next</span>
        </li>
      {% endif %}
    </ul>
  </nav>

</body>
</html>
